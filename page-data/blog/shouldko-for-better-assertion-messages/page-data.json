{"componentChunkName":"component---src-templates-post-template-tsx","path":"/blog/shouldko-for-better-assertion-messages","result":{"data":{"markdownRemark":{"html":"<p>Most of us write tests these days. Whether they are unit, integration, end-to-end or performance tests once written we often do not go back to them until they fail. It is thus vital to have a clear assertion message when a test fails.</p>\n<p><img src=\"/images/shouldko-1/search.jpg\" alt=\"search\"></p>\n<h1>Hamcrest</h1>\n<p>I think <a href=\"http://hamcrest.org/\">Hamcrest</a> is the most popular assertion library available in Java and Kotlin ecosystem. Let us look at an oversimplified example of <a href=\"https://martinfowler.com/bliki/ValueObject.html\"><code>Money</code></a> class:</p>\n<pre><code class=\"language-kotlin\">import java.math.BigDecimal\nimport java.util.*\n\ndata class Money(val amount: BigDecimal, val currency: Currency) {\n    operator fun plus(other: Money): Money {\n        if (currency != other.currency) {\n            throw IllegalArgumentException(\"Cannot add $this to $other. Currencies must match.\")\n        }\n\n        // an accidentally introduced bug üòà\n        val newAmount = amount + other.amount + 10.0.toBigDecimal()\n        return copy(amount = newAmount)\n    }\n}\n</code></pre>\n<p>Imagine we write a test for the <a href=\"https://kotlinlang.org/docs/reference/operator-overloading.html\"><code>plus</code></a> operator using <a href=\"http://junit.org/junit5/\">JUnit</a> and <a href=\"http://hamcrest.org/\">Hamcrest</a>:</p>\n<pre><code>class MoneyTests {\n    val usd = Currency.getInstance(\"USD\")\n\n    @Test\n    fun can_add() {\n        val usd100 = Money(100.toBigDecimal(), usd)\n        val usd50 = Money(50.toBigDecimal(), usd)\n\n        assertThat((usd100 + usd50).amount, equalTo(150.toBigDecimal()))\n    }\n}\n</code></pre>\n<p>The test will fail with the following message:</p>\n<pre><code>java.lang.AssertionError: \nExpected: &#x3C;150>\n     but: was &#x3C;160>\n</code></pre>\n<p>Let's see how we can improve on that.</p>\n<h1>ShouldKO: better assertion messages for Kotlin</h1>\n<p><a href=\"https://github.com/miensol/shouldko\">ShouldKO</a> is a simple library I've come up with that improves the assertion messages. Its idea is based on assertion libraries available in .NET e.g. <a href=\"https://github.com/shouldly/shouldly\">Shouldly</a>. Let us see how the tests looks like using <a href=\"https://github.com/miensol/shouldko\">ShouldKO</a>:</p>\n<pre><code class=\"language-kotlin\">class MoneyTests {\n    val usd = Currency.getInstance(\"USD\")\n\n    @Test\n    fun can_add() {\n        val usd100 = Money(100.toBigDecimal(), usd)\n        val usd50 = Money(50.toBigDecimal(), usd)\n\n        (usd100 + usd50).amount.shouldEqual(150.toBigDecimal())\n    }\n}\n</code></pre>\n<p>In my opinion <a href=\"https://github.com/miensol/shouldko\">ShouldKO's</a> assertion syntax improves readability. However, this is not where <a href=\"https://github.com/miensol/shouldko\">ShouldKO</a> main improvement is. Follow the improved assertion message:</p>\n<pre><code>java.lang.AssertionError: (usd100 + usd50).amount \nExpected: &#x3C;150>\n     but: was &#x3C;160>\n</code></pre>\n<p><a href=\"https://github.com/miensol/shouldko\">ShouldKO</a> incorporates a source code line with the assertion into the assertion message itself. This comes really handy when we have multiple lines with assertions that form one logical condition. This is a small thing, but can greatly improve debugging test issues especially when all we have is a log file produced by a test run.</p>\n<h2>Installation of ShouldKO</h2>\n<p><a href=\"https://github.com/miensol/shouldko\">ShouldKO</a> is currently available on <a href=\"https://jitpack.io/\">Jitpack</a>. You need to first add Jitpack to your repositories:</p>\n<pre><code class=\"language-groovy\">repositories {\n    maven { url 'https://jitpack.io' }\n    mavenCentral()\n}\n</code></pre>\n<p>And include the library in your tests e.g.:</p>\n<pre><code class=\"language-groovy\">testImplementation 'com.github.miensol.shouldko:hamcrest:v0.1.0'\n</code></pre>\n<p><a href=\"https://github.com/miensol/shouldko\">ShouldKO's</a> Hamcrest library allows for using any Hamcrest matcher.</p>","excerpt":"Most of us write tests these days. Whether they are unit, integration, end-to-end or performance tests once written we often do not go back‚Ä¶","frontmatter":{"slug":null,"title":"Use ShouldKO for better assertion messages","description":null,"author":"piotr","tags":["junit","hamcreset","kotlin","assertion","tests"],"date":"2018-01-16T23:00:00.000Z","image":"/images/shouldko-1/search.jpg"},"timeToRead":2,"fileAbsolutePath":"/home/runner/work/new-www/new-www/src/mdData/blog/2018-01-17-shouldko-for-better-assertion-messages.md"},"allMarkdownRemark":{"nodes":[{"frontmatter":{"author_id":"adam","avatar":"/images/members/adam_bar.jpg","bio":"The Web Guy @ Bright Inventions","name":"Adam Bar","web":"https://whatwebcando.today"}},{"frontmatter":{"author_id":"agnieszka_h","avatar":"/images/members/agnieszka_h.jpg","bio":"Sales Manager @ Bright Inventions","name":"Agnieszka Hayashida","web":null}},{"frontmatter":{"author_id":"agnieszka","avatar":"/images/members/agnieszka_olszewska.jpg","bio":"Fullstack developer","name":"Agnieszka Olszewska","web":null}},{"frontmatter":{"author_id":"olo","avatar":"/images/members/aleksander_wielgorski.jpeg","bio":"Software Engineer @ Bright Inventions","name":"Aleksander Wielg√≥rski","web":null}},{"frontmatter":{"author_id":"alisa","avatar":"/images/members/alisa_kashytska.jpg","bio":"Product designer","name":"Alisa Kashytska","web":null}},{"frontmatter":{"author_id":"azabost","avatar":"/images/members/andrzej_zabost.jpg","bio":"Senior Android developer","name":"Andrzej Zabost","web":"https://azabost.com"}},{"frontmatter":{"author_id":"arturs","avatar":"/images/members/artur.jpg","bio":"iOS developer","name":"Artur Suli≈Ñski","web":null}},{"frontmatter":{"author_id":"bartek k","avatar":"/images/members/bartek_krzyzanski.jpg","bio":"Backend developer","name":"Bartek Krzy≈ºa≈Ñski","web":null}},{"frontmatter":{"author_id":"bartekr","avatar":"/images/members/bartek.jpg","bio":"iOS developer","name":"Bartek Rozwarski","web":null}},{"frontmatter":{"author_id":"bartosz","avatar":"/images/members/bartosz_szafran.jpg","bio":"Senior Frontend Developer","name":"Bartosz Szafran","web":null}},{"frontmatter":{"author_id":"daniel","avatar":"/images/members/daniel_makurat.jpg","bio":"Co-founder & Senior Backend developer","name":"Daniel Makurat","web":null}},{"frontmatter":{"author_id":"eliasz","avatar":"/images/members/eliasz.png","bio":"Software Engineer @ Bright Inventions","name":"Eliasz Sawicki","web":"http://eluss.github.io/"}},{"frontmatter":{"author_id":"fjablonski","avatar":"/images/members/filip_jablonski.jpg","bio":"Senior iOS developer","name":"Filip Jab≈Ço≈Ñski","web":null}},{"frontmatter":{"author_id":"grzesiek","avatar":"/images/members/grzegorz_ciesla.jpg","bio":"Software Developer","name":"Grzegorz Cie≈õla","web":null}},{"frontmatter":{"author_id":"ivan","avatar":"/images/members/ivan.jpg","bio":"Fullstack developer","name":"Ivan Menshykov","web":null}},{"frontmatter":{"author_id":"janek","avatar":"/images/members/janhanc.jpg","bio":"Frontend developer","name":"Jan Hanc","web":null}},{"frontmatter":{"author_id":"kwysocki","avatar":"/images/members/kamil.png","bio":"Software Engineer @ Bright Inventions","name":"Kamil Wysocki","web":"https://wysockikamil.com"}},{"frontmatter":{"author_id":"karoln","avatar":"/images/members/karol_nadratowski.jpg","bio":null,"name":"Karol Nadratowski","web":null}},{"frontmatter":{"author_id":"karol r","avatar":"/images/members/karol_rinc.jpg","bio":"Backend developer","name":"Karol Rinc","web":null}},{"frontmatter":{"author_id":"kasia","avatar":"/images/members/kasia_lukasiewicz.jpg","bio":"Senior Project Manager","name":"Kasia ≈Åukasiewicz","web":null}},{"frontmatter":{"author_id":"kasia g","avatar":"/images/members/katarzyna_galka.jpg","bio":"Project manager","name":"Katarzyna Ga≈Çka","web":null}},{"frontmatter":{"author_id":"krzysiek h","avatar":"/images/members/krzysztof_hinc.jpg","bio":"Web developer","name":"Krzysiek Hinc","web":null}},{"frontmatter":{"author_id":"krzysiek","avatar":"/images/members/krzysztof_kaczmarek.jpg","bio":"Senior iOS Developer","name":"Krzysztof Kaczmarek","web":null}},{"frontmatter":{"author_id":"maciej","avatar":"/images/members/maciej_seleman.jpg","bio":"QA Specialist","name":"Maciej Seleman","web":null}},{"frontmatter":{"author_id":"magda","avatar":"/images/members/magda_sadowska.jpg","bio":"Office & HR Assistant","name":"Magda Sadowska","web":null}},{"frontmatter":{"author_id":"maja","avatar":"/images/members/maja_puta.jpg","bio":"Junior QA Specialist","name":"Maja Puta","web":null}},{"frontmatter":{"author_id":"marcink","avatar":"/images/members/marcin_kwiatkowski.jpg","bio":null,"name":"Marcin Kwiatkowski","web":null}},{"frontmatter":{"author_id":"mateusz","avatar":"/images/members/mateusz_klimczak.jpg","bio":"Technical leader & Project manager","name":"Mateusz Klimczak","web":null}},{"frontmatter":{"author_id":"mateuszklimek","avatar":"/images/members/mateuszklimek.png","bio":"Software Engineer @ Bright Inventions","name":"Mateusz Klimek","web":null}},{"frontmatter":{"author_id":"michal k","avatar":"/images/members/michal_koszalka.jpg","bio":"Senior Backend developer","name":"Micha≈Ç Kosza≈Çka","web":null}},{"frontmatter":{"author_id":"micha≈Ç","avatar":"/images/members/michal_wrobel.jpg","bio":"Senior Backend Developer at Bright Inventions","name":"Micha≈Ç Wr√≥bel","web":null}},{"frontmatter":{"author_id":"michal","avatar":"/images/members/micha≈Ç_≈Çukasiewicz.jpg","bio":"Co-founder & Senior iOS developer","name":"Micha≈Ç ≈Åukasiewicz","web":null}},{"frontmatter":{"author_id":"monika","avatar":"/images/members/monika.jpg","bio":"Software Developer @ Bright Inventions","name":"Monika Niegrzybowska","web":null}},{"frontmatter":{"author_id":"nikodem","avatar":"/images/members/nikodem_kalinowski.jpg","bio":"Web developer","name":"Nikodem Kalinowski","web":null}},{"frontmatter":{"author_id":"patryk","avatar":"/images/members/patryk_huzarski.jpg","bio":"Software Developer @ Bright Inventions","name":"Patryk Huzarski","web":null}},{"frontmatter":{"author_id":"patryk sz","avatar":"/images/members/patryk_szlagowski.jpg","bio":"Senior Backend developer","name":"Patryk Szlagowski","web":null}},{"frontmatter":{"author_id":"pawe≈Ç","avatar":"/images/members/pawe≈Ç_gutkowski.jpg","bio":"Fullstack Developer at Bright Inventions ","name":"Pawe≈Ç Gutkowski","web":null}},{"frontmatter":{"author_id":"pawel","avatar":"/images/members/pawe≈Ç_papkiewicz.jpg","bio":"Fullstack developer","name":"Pawe≈Ç Papkiewicz","web":null}},{"frontmatter":{"author_id":"piotr","avatar":"/images/members/piotr_mionskowski.jpg","bio":"TDD fan eager to learn new things","name":"Piotr Mionskowski","web":"https://miensol.pl"}},{"frontmatter":{"author_id":"piotr_l","avatar":"/images/members/piotrl.png","bio":"Android Developer @ Bright Inventions","name":"Piotr ≈Åupi≈Ñski","web":"http://exp.flamaster2.com"}},{"frontmatter":{"author_id":"radek","avatar":"/images/members/radek_pieczaÃ®tkiewicz.jpg","bio":"Android developer","name":"Radek PieczƒÖtkiewicz","web":null}},{"frontmatter":{"author_id":"radeks","avatar":"/images/members/radoslaw.jpg","bio":"Software Engineer @ Bright Inventions","name":"Rados≈Çaw S≈Çowi≈Ñski","web":null}},{"frontmatter":{"author_id":"rafal h","avatar":"/images/members/rafal_hoffman.jpg","bio":"Fullstack developer","name":"Rafa≈Ç Hofman","web":null}},{"frontmatter":{"author_id":"sebastian","avatar":"/images/members/sebastian_sobczak.jpg","bio":"Junior Account Manager at Bright Inventions ","name":"Sebastian Sobczak","web":null}},{"frontmatter":{"author_id":"szymek","avatar":"/images/members/szymon_miloch.jpg","bio":"Android & Web developer","name":"Szymon Miloch","web":null}},{"frontmatter":{"author_id":"tomek","avatar":"/images/members/tomek.jpeg","bio":null,"name":"Tomasz Gƒôsior","web":null}},{"frontmatter":{"author_id":"ula","avatar":"/images/members/ula_stankiewicz.jpg","bio":"HR & Marketing Manager","name":"Ula Stankiewicz","web":null}},{"frontmatter":{"author_id":"wojciech","avatar":"/images/members/wojciech_baczynÃÅski.jpg","bio":"Fullstack developer","name":"Wojciech Baczy≈Ñski","web":null}},{"frontmatter":{"author_id":"lukasz","avatar":"/images/members/lukasz_reszetow.jpg","bio":"Android developer","name":"≈Åukasz Reszetow","web":null}}]},"site":{"siteMetadata":{"siteUrl":"https://brightinventions.pl"}}},"pageContext":{"fileAbsolutePath":"/home/runner/work/new-www/new-www/src/mdData/blog/2018-01-17-shouldko-for-better-assertion-messages.md"}}}