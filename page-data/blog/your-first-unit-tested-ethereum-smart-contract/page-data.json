{"componentChunkName":"component---src-templates-post-template-tsx","path":"/blog/your-first-unit-tested-ethereum-smart-contract","result":{"data":{"markdownRemark":{"html":"<p>The goal of that blog post is to provide you with the exact steps how to start creating your first unit tested smart contract. </p>\n<h1>My toolbox</h1>\n<p>While writing this article I was using Parity 1.7.8-stable (Parity/v1.7.8-stable-d5fcf3b-20171025/x86_64-macos/rustc1.21.0) as a Ethereum client. You can find an installation guide on this site: <a href=\"https://github.com/paritytech/parity\">Parity - fast, light, and robust Ethereum client</a> or if you are on macOSX or Debian based Linux, please follow instructions described in the next paragraphs. </p>\n<h1>Installing parity on macOSX</h1>\n<p>If you don't have a <code>homebrew</code> package manager installed yet, please execute:</p>\n<pre><code>/usr/bin/ruby -e \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)\"\n</code></pre>\n<p>and now the parity installation:</p>\n<pre><code>brew tap paritytech/paritytech\nbrew install parity --stable\n</code></pre>\n<h1>Installing parity on Linux</h1>\n<p>Almost all parity packages you can find here: <code>https://github.com/paritytech/parity/releases</code>. To install on Debian based Linux you will need wget and dpkg. Below as an example installation of parity 1.7.9-stable:</p>\n<pre><code>wget https://parity-downloads-mirror.parity.io/v1.7.9/x86_64-unknown-linux-gnu/parity_1.7.9_amd64.deb\nsudo dpkg -i parity_1.7.9_amd64.deb\n</code></pre>\n<h1>Starting parity</h1>\n<p>For the purpose of that article we will start parity with:    </p>\n<ul>\n<li>private development chain definition <code>--chain=dev</code>        </li>\n<li>JSON RPC APIs: <code>--jsonrpc-apis web3,rpc,personal,parity_accounts,eth,net,parity,parity_set,signer</code>    </li>\n<li>gas price set to 0 <code>--gasprice 0</code>    </li>\n<li>interface IP address <code>--ui-interface 0.0.0.0</code>    </li>\n<li>disabled host name validation <code>--ui-no-validation</code>    </li>\n<li>allowing all hosts (Host header values) for using JSON RPC API <code>--jsonrpc-hosts all</code>    </li>\n<li>interface's IP address - all interfaces <code>--jsonrpc-interface all</code><br>\n</li>\n</ul>\n<pre><code>parity --chain=dev --jsonrpc-apis web3,rpc,personal,parity_accounts,eth,net,parity,parity_set,signer --gasprice 0 --ui-interface 0.0.0.0 --ui-no-validation --jsonrpc-hosts all --jsonrpc-interface all\n</code></pre>\n<p>Now we do need an account with some ether amount to be able to perform transactions. Parity development chain allows you to create an account with almost unlimited ether amount but only on a development chain. You will not find creating such an account as an regular UI option, it's available as a hack. Please first open a link to parity UI (<code>http://0.0.0.0:8180/</code>) and open ACCOUNTS and then RESTORE,you should see:\n<img src=\"/images/smart-contract-create-test-and-deploy/parity-restore-super-account-1.jpg\" alt=\"Restore super account 1\"></p>\n<p>The trick is to restore an account with an empty recovery phrase. Please fill in the account name, password hint, passwords and click IMPORT on the right bottom corner:\n<img src=\"/images/smart-contract-create-test-and-deploy/parity-restore-super-account-2.jpg\" alt=\"Restore super account 2\"></p>\n<p>Once the account is created, you should see:\n<img src=\"/images/smart-contract-create-test-and-deploy/parity-restore-super-account-3.jpg\" alt=\"Restore super account 3\"></p>\n<p> Next step is to run parity node with unlocked account on which we will execute all test transactions, so you will not need to sign every test transaction via Signer available via parity UI. To do that please first kill already started parity process and run that process with two additional parameters:    </p>\n<ul>\n<li>address to unlock <code>--unlock 0x00a329c0648769A73afAc7F9381E08FB43dBEA72</code>        </li>\n<li>user password for specified account to unlock <code>--password ./password</code>, where <code>./password</code> is a path to a file containing user password    </li>\n</ul>\n<pre><code>parity --chain=dev --jsonrpc-apis web3,rpc,personal,parity_accounts,eth,net,parity,parity_set,signer --gasprice 0 --ui-interface 0.0.0.0 --ui-no-validation --jsonrpc-hosts all --jsonrpc-interface all --unlock 0x00a329c0648769A73afAc7F9381E08FB43dBEA72 --password ./password\n</code></pre>\n<p>Which should result in something like this:\n<img src=\"/images/smart-contract-create-test-and-deploy/running-parity.jpg\" alt=\"Parity in terminal\"></p>\n<p>Parity node is ready! :) </p>\n<h1>Creating and testing Smart Contract - Truffle</h1>\n<p>The fastest and the simplest way I know to create, test and build smart contract is by using <a href=\"http://truffleframework.com/docs/getting_started/project\">truffle</a> tool. You can install truffle using npm (node version 6.11.4) package manager:<br>\n<code>npm install -g truffle@4.0.1</code>     </p>\n<p>Now please prepare an empty folder for your new project and execute the following command to initialize the truffle project structure:</p>\n<pre><code>truffle init\n</code></pre>\n<p>then please open and edit configuration file <code>truffle.js</code>, <code>from</code> parameter is an address from which all truffle transactions should be executed by default, please set as a value the address of the already created/restored account.</p>\n<pre><code class=\"language-javascript\">module.exports = {  \n  // See &#x3C;http://truffleframework.com/docs/advanced/configuration>  \n    networks: { \n        development: {  \n            host: \"localhost\",  \n            port: 8545, \n            network_id: \"*\",    \n            from: \"0x00a329c0648769A73afAc7F9381E08FB43dBEA72\", \n            gas: 5959115    \n        }   \n    }   \n};  \n</code></pre>\n<p>For the purpose of that article I've decided to create a smart contract which stores the sum of all values added by calling <code>add</code> method. Method <code>add</code> is restricted to be called only by a smart contract owner.   </p>\n<pre><code class=\"language-solidity\">pragma solidity ^0.4.17;    \n    \ncontract TestSmartContract {    \n    address public owner;   \n    uint public total;  \n    \n    modifier restricted() { \n        if (msg.sender == owner) _; \n    }   \n    \n    function TestSmartContract() public {   \n        owner = msg.sender; \n    }   \n    \n    function add(uint amount) public restricted {   \n        total = total + amount; \n    }   \n}   \n</code></pre>\n<p>Having the smart contract we need to create migration that will deploy that smart contract. To do that we need to create a new file: <code>2_test_smart_contract.js</code> inside <code>migrations</code> folder:</p>\n<pre><code class=\"language-javascript\">var TestSmartContract = artifacts.require(\"./TestSmartContract.sol\");      \nmodule.exports = function(deployer) {   \n    deployer.deploy(TestSmartContract); \n};  \n</code></pre>\n<p>Now we need to execute migration by executing:</p>\n<p><code>truffle migrate</code>   </p>\n<p>We are ready to start writing and executing unit tests. Below you can find two unit tests, the first one asserts if we call add method with value 4 then the total would equal to 4 and the second one - if we add: 6, 4, 20 total would be equal to 30. In <code>beforeEach</code> block we do create a new smart contract and read the contract owner address. </p>\n<pre><code class=\"language-javascript\">const TestContract = artifacts.require('TestSmartContract');\n\nlet TestContractDeployed;\nlet ContractOwner;\n\ncontract('TestContract', (accounts) => {\n\n    beforeEach('prepare', () => {\n        return TestContract.new().then((instance) => {\n            TestContractDeployed = instance;\n            return TestContractDeployed.owner();\n        }).then(function (owner) {\n            ContractOwner = owner;\n        });\n    });\n\n    describe('test add method', () => {\n\n        it('total should be 4 if add(4)', (done) => {\n            TestContractDeployed.add(4, {from: ContractOwner}).then(function () {\n                TestContractDeployed.total({from: ContractOwner}).then(function (res) {\n                    assert.equal(res.valueOf(), 4);\n                    done();\n                });\n            });\n        });\n\n        it('total should be 30 if add(6);add(4);add(20);', (done) => {\n            Promise.all([\n                TestContractDeployed.add(6, {from: ContractOwner}),\n                TestContractDeployed.add(4, {from: ContractOwner}),\n                TestContractDeployed.add(20, {from: ContractOwner})\n            ]).then(() => {\n                TestContractDeployed.total({from: ContractOwner}).then(function (res) {\n                    assert.equal(res.valueOf(), 30);\n                    done();\n                });\n            });\n        });\n\n    });\n\n});\n</code></pre>\n<p>For more information it's definitely worth to visiting <a href=\"https://truffle.readthedocs.io/en/beta/\">truffle docs</a></p>\n<p>All the code that was generated during that post creation you can find here <a href=\"https://github.com/bright/smart-contract\">smart-contract repo</a></p>\n<p>Hope you have liked it! :) </p>","excerpt":"The goal of that blog post is to provide you with the exact steps how to start creating your first unit tested smart contract.  My toolbox…","frontmatter":{"slug":null,"title":"Your first unit tested Ethereum Smart Contract","description":null,"author":"daniel","tags":["smartcontract","ethereum","blockchain","truffle","web3js","parity","unittests"],"date":"2017-11-12T23:00:00.000Z","image":null},"timeToRead":5,"fileAbsolutePath":"/home/runner/work/new-www/new-www/src/mdData/blog/2017-11-13-your-first-unit-tested-ethereum-smart-contract.md"},"allMarkdownRemark":{"nodes":[{"frontmatter":{"author_id":"adam","avatar":"/images/members/adam_bar.jpg","bio":"The Web Guy @ Bright Inventions","name":"Adam Bar","web":"https://whatwebcando.today"}},{"frontmatter":{"author_id":"agnieszka_h","avatar":"/images/members/agnieszka_h.jpg","bio":"Sales Manager @ Bright Inventions","name":"Agnieszka Hayashida","web":null}},{"frontmatter":{"author_id":"agnieszka","avatar":"/images/members/agnieszka_olszewska.jpg","bio":"Fullstack developer","name":"Agnieszka Olszewska","web":null}},{"frontmatter":{"author_id":"olo","avatar":"/images/members/aleksander_wielgorski.jpeg","bio":"Software Engineer @ Bright Inventions","name":"Aleksander Wielgórski","web":null}},{"frontmatter":{"author_id":"alisa","avatar":"/images/members/alisa_kashytska.jpg","bio":"Product designer","name":"Alisa Kashytska","web":null}},{"frontmatter":{"author_id":"azabost","avatar":"/images/members/andrzej_zabost.jpg","bio":"Senior Android developer","name":"Andrzej Zabost","web":"https://azabost.com"}},{"frontmatter":{"author_id":"arturs","avatar":"/images/members/artur.jpg","bio":"iOS developer","name":"Artur Suliński","web":null}},{"frontmatter":{"author_id":"bartek k","avatar":"/images/members/bartek_krzyzanski.jpg","bio":"Backend developer","name":"Bartek Krzyżański","web":null}},{"frontmatter":{"author_id":"bartekr","avatar":"/images/members/bartek.jpg","bio":"iOS developer","name":"Bartek Rozwarski","web":null}},{"frontmatter":{"author_id":"bartosz","avatar":"/images/members/bartosz_szafran.jpg","bio":"Senior Frontend Developer","name":"Bartosz Szafran","web":null}},{"frontmatter":{"author_id":"daniel","avatar":"/images/members/daniel_makurat.jpg","bio":"Co-founder & Senior Backend developer","name":"Daniel Makurat","web":null}},{"frontmatter":{"author_id":"eliasz","avatar":"/images/members/eliasz.png","bio":"Software Engineer @ Bright Inventions","name":"Eliasz Sawicki","web":"http://eluss.github.io/"}},{"frontmatter":{"author_id":"fjablonski","avatar":"/images/members/filip_jablonski.jpg","bio":"Senior iOS developer","name":"Filip Jabłoński","web":null}},{"frontmatter":{"author_id":"grzesiek","avatar":"/images/members/grzegorz_ciesla.jpg","bio":"Software Developer","name":"Grzegorz Cieśla","web":null}},{"frontmatter":{"author_id":"ivan","avatar":"/images/members/ivan.jpg","bio":"Fullstack developer","name":"Ivan Menshykov","web":null}},{"frontmatter":{"author_id":"janek","avatar":"/images/members/janhanc.jpg","bio":"Frontend developer","name":"Jan Hanc","web":null}},{"frontmatter":{"author_id":"kwysocki","avatar":"/images/members/kamil.png","bio":"Software Engineer @ Bright Inventions","name":"Kamil Wysocki","web":"https://wysockikamil.com"}},{"frontmatter":{"author_id":"karoln","avatar":"/images/members/karol_nadratowski.jpg","bio":null,"name":"Karol Nadratowski","web":null}},{"frontmatter":{"author_id":"karol r","avatar":"/images/members/karol_rinc.jpg","bio":"Backend developer","name":"Karol Rinc","web":null}},{"frontmatter":{"author_id":"kasia","avatar":"/images/members/kasia_lukasiewicz.jpg","bio":"Senior Project Manager","name":"Kasia Łukasiewicz","web":null}},{"frontmatter":{"author_id":"kasia g","avatar":"/images/members/katarzyna_galka.jpg","bio":"Project manager","name":"Katarzyna Gałka","web":null}},{"frontmatter":{"author_id":"krzysiek h","avatar":"/images/members/krzysztof_hinc.jpg","bio":"Web developer","name":"Krzysiek Hinc","web":null}},{"frontmatter":{"author_id":"krzysiek","avatar":"/images/members/krzysztof_kaczmarek.jpg","bio":"Senior iOS Developer","name":"Krzysztof Kaczmarek","web":null}},{"frontmatter":{"author_id":"maciej","avatar":"/images/members/maciej_seleman.jpg","bio":"QA Specialist","name":"Maciej Seleman","web":null}},{"frontmatter":{"author_id":"magda","avatar":"/images/members/magda_sadowska.jpg","bio":"Office & HR Assistant","name":"Magda Sadowska","web":null}},{"frontmatter":{"author_id":"maja","avatar":"/images/members/maja_puta.jpg","bio":"Junior QA Specialist","name":"Maja Puta","web":null}},{"frontmatter":{"author_id":"marcink","avatar":"/images/members/marcin_kwiatkowski.jpg","bio":null,"name":"Marcin Kwiatkowski","web":null}},{"frontmatter":{"author_id":"mateusz","avatar":"/images/members/mateusz_klimczak.jpg","bio":"Technical leader & Project manager","name":"Mateusz Klimczak","web":null}},{"frontmatter":{"author_id":"mateuszklimek","avatar":"/images/members/mateuszklimek.png","bio":"Software Engineer @ Bright Inventions","name":"Mateusz Klimek","web":null}},{"frontmatter":{"author_id":"michal k","avatar":"/images/members/michal_koszalka.jpg","bio":"Senior Backend developer","name":"Michał Koszałka","web":null}},{"frontmatter":{"author_id":"michał","avatar":"/images/members/michal_wrobel.jpg","bio":"Senior Backend Developer at Bright Inventions","name":"Michał Wróbel","web":null}},{"frontmatter":{"author_id":"michal","avatar":"/images/members/michał_łukasiewicz.jpg","bio":"Co-founder & Senior iOS developer","name":"Michał Łukasiewicz","web":null}},{"frontmatter":{"author_id":"monika","avatar":"/images/members/monika.jpg","bio":"Software Developer @ Bright Inventions","name":"Monika Niegrzybowska","web":null}},{"frontmatter":{"author_id":"nikodem","avatar":"/images/members/nikodem_kalinowski.jpg","bio":"Web developer","name":"Nikodem Kalinowski","web":null}},{"frontmatter":{"author_id":"patryk","avatar":"/images/members/patryk_huzarski.jpg","bio":"Software Developer @ Bright Inventions","name":"Patryk Huzarski","web":null}},{"frontmatter":{"author_id":"patryk sz","avatar":"/images/members/patryk_szlagowski.jpg","bio":"Senior Backend developer","name":"Patryk Szlagowski","web":null}},{"frontmatter":{"author_id":"paweł","avatar":"/images/members/paweł_gutkowski.jpg","bio":"Fullstack Developer at Bright Inventions ","name":"Paweł Gutkowski","web":null}},{"frontmatter":{"author_id":"pawel","avatar":"/images/members/paweł_papkiewicz.jpg","bio":"Fullstack developer","name":"Paweł Papkiewicz","web":null}},{"frontmatter":{"author_id":"piotr","avatar":"/images/members/piotr_mionskowski.jpg","bio":"TDD fan eager to learn new things","name":"Piotr Mionskowski","web":"https://miensol.pl"}},{"frontmatter":{"author_id":"piotr_l","avatar":"/images/members/piotrl.png","bio":"Android Developer @ Bright Inventions","name":"Piotr Łupiński","web":"http://exp.flamaster2.com"}},{"frontmatter":{"author_id":"radek","avatar":"/images/members/radek_pieczątkiewicz.jpg","bio":"Android developer","name":"Radek Pieczątkiewicz","web":null}},{"frontmatter":{"author_id":"radeks","avatar":"/images/members/radoslaw.jpg","bio":"Software Engineer @ Bright Inventions","name":"Radosław Słowiński","web":null}},{"frontmatter":{"author_id":"rafal h","avatar":"/images/members/rafal_hoffman.jpg","bio":"Fullstack developer","name":"Rafał Hofman","web":null}},{"frontmatter":{"author_id":"sebastian","avatar":"/images/members/sebastian_sobczak.jpg","bio":"Junior Account Manager at Bright Inventions ","name":"Sebastian Sobczak","web":null}},{"frontmatter":{"author_id":"szymek","avatar":"/images/members/szymon_miloch.jpg","bio":"Android & Web developer","name":"Szymon Miloch","web":null}},{"frontmatter":{"author_id":"tomek","avatar":"/images/members/tomek.jpeg","bio":null,"name":"Tomasz Gęsior","web":null}},{"frontmatter":{"author_id":"ula","avatar":"/images/members/ula_stankiewicz.jpg","bio":"HR & Marketing Manager","name":"Ula Stankiewicz","web":null}},{"frontmatter":{"author_id":"wojciech","avatar":"/images/members/wojciech_baczyński.jpg","bio":"Fullstack developer","name":"Wojciech Baczyński","web":null}},{"frontmatter":{"author_id":"lukasz","avatar":"/images/members/lukasz_reszetow.jpg","bio":"Android developer","name":"Łukasz Reszetow","web":null}}]},"site":{"siteMetadata":{"siteUrl":"https://brightinventions.pl"}}},"pageContext":{"fileAbsolutePath":"/home/runner/work/new-www/new-www/src/mdData/blog/2017-11-13-your-first-unit-tested-ethereum-smart-contract.md"}}}