{"componentChunkName":"component---src-templates-post-template-tsx","path":"/blog/iota-hello-world","result":{"data":{"markdownRemark":{"html":"<p>Previously in the IOTA series we've looked into <a href=\"/blog/iota-new-kid-in-cryptocurrency-town/\">the assumptions of this promising cryptocurrency system</a> and we've <a href=\"/blog/getting-started-with-iota/\">connected to the network with our own node</a>. It's high time to interact with IOTA programatically.</p>\n<p>IOTA nodes (or, actually, as the creators of the system prefer to call it - IOTA Reference Implementations) expose an HTTP API that we can interact with and - unlike most of the IOTA's ecosystem - has an <a href=\"https://iota.readme.io/v1.2.0/reference\">actual documentation</a> available. But while it is indispensable to look into this reference, we'll rather use the client libraries to talk to our node. </p>\n<p>There are <a href=\"https://iota.readme.io/docs/overview\">three official client libraries</a> out there at the moment and the most mature one is apparently the one we'd like to use - a JavaScript one called <a href=\"https://github.com/iotaledger/iota.lib.js\">iota.lib.js</a>. It is basically a wrapper for the API endpoints.</p>\n<h2>Talking to node using Node</h2>\n<p>Let's start with the empty Node.JS project that we can bootstrap using <code>npm init</code>. Then install IOTA's library with <code>npm install iota.lib.js --save</code> and jump into the code.</p>\n<p>To establish a connection, we need to specify where is our IRI, including the public API port (specified as <code>PORT</code> in the node's config file or as <code>-p</code> if passed from command line). Note that by default we don't need any credentials here - that's why it is important to keep our node's API port hidden from the external network or configured properly with <code>--remote-auth</code> and <code>--remote-limit-api</code> <a href=\"https://iota.readme.io/v1.2.0/docs/install-iri\">configuration options</a> to avoid everyone to mess with our beloved node.</p>\n<pre><code class=\"language-javascript\">const IOTA = require('iota.lib.js')\nconst iota = new IOTA({\n    host: 'http://192.168.1.162',\n    port: 14265\n})\n</code></pre>\n<p>Now let's see what our node tells us about itself using <a href=\"https://iota.readme.io/v1.2.0/reference#getnodeinfo\"><code>getNodeInfo</code></a> call. All the API calls adhere to the clumsy Node.JS <a href=\"https://www.joyent.com/node-js/production/design/errors\">callback passing convention</a>:</p>\n<pre><code class=\"language-javascript\">iota.api.getNodeInfo((error, nodeInfo) => {\n    if (error) {\n        console.error('getNodeInfo error', error)\n    } else {\n        console.log('getNodeInfo result', nodeInfo)\n    }\n}\n</code></pre>\n<p>What we'll get in return, apart from the node's version and footprint information, is the processing state - whether there are any pending transactions to transmit and what is the latest milestone known to our node. This latter value should change every several minutes if our node is in sync with the network.</p>\n<h2>Where's my wallet?</h2>\n<p>Addresses in IOTA can be understood as distinct wallets that can store IOTA tokens. These are long enough strings, so that it's totally fine to generate it on your own and - in practice - be sure about its uniqueness. </p>\n<p>In order to claim the ownership of a given address, we need to have the seed it was generated from - think of the seed as a private key to your box with wallets. The seed <a href=\"https://iotasupport.com/gui-newseed.shtml\">needs to be generated securely</a>, probably not using the public websites that does it for you. The easiest would probably be to use macOS/Linux terminal and run:</p>\n<pre><code>cat /dev/urandom | LC_ALL=C tr -dc 'A-Z9' | fold -w 81 | head -n 1\n</code></pre>\n<p>Now, the thing we got back, looking similar to <code>FNCWNXJWJIVDGPRWNZYKOMKNIIATPPDKEVCZEWSZTEVIWJFCOUV9PJD9AUCEVQLFEAI9UBUAVQKVEBLKN</code>, is our seed. We're responsible for storing it securely and privately because it gives a full access to all the addresses (wallets) we'll create using it.</p>\n<p>To actually generate the address we can use to send transactions to, let's use our API:</p>\n<pre><code class=\"language-javascript\">const seed = 'FNCWNXJWJIVDGPRWNZYKOMKNIIATPPDKEVCZEWSZTEVIWJFCOUV9PJD9AUCEVQLFEAI9UBUAVQKVEBLKN' // keep it secure!\niota.api.getNewAddress(seed, (error, address) => {\n   if (error) {\n       console.error('getNewAddress error', error)\n   } else {\n       console.log('new address generated: ' + address)\n   }\n})\n</code></pre>\n<h2>Spending the tokens</h2>\n<p>We're now ready to submit our first transaction, or - how the API calls it - the transfer. Apart from the monetary value (which can be zero), we can attach a message to our transaction. The message needs to be <a href=\"https://learn.iota.org/faq/trytes-and-trits\">tryte-encoded</a> - we don't need to care much about it fortunately as we have a helper method for this task: <a href=\"https://github.com/iotaledger/iota.lib.js#totrytes\"><code>iota.utils.toTrytes</code></a>.</p>\n<p>The code to send our transaction to the IOTA's tangle is as follows:</p>\n<pre><code class=\"language-javascript\">const Depth = 3 // constant defined by IOTA - how deep to look for the tips in the Tangle\nconst MinWeightMagnitude = 16 // constant defined by IOTA - the difficulty of PoW\n\nconst transfers = [\n    {\n        // where are we sending the transaction to?\n        address: 'CHNLHJCYBZCYUI9DTHINDDWHNJWFCHQOTGABXFVZQHXF9BROTOIJZJSBXOVKCDGCXZTDDJUVTYBJZYAOH',\n        \n        // how many tokens are we transferring?\n        value: 42,\n        \n        // do we want to comment on this transaction?\n        message: iota.utils.toTrytes('Hello World!')        \n    }\n]\n\nconst options = {\n    // addresses of the wallets we're using to fund this transfer\n    inputs: ['ZISNLNSKMPDOORSSFRCBGQOPY9BI9SONMTDHJJDWBTTCYLFV9PQ9VSWNI9FHEAEFGROGZ9YHSMZYOGFQG']\n}\n\niota.api.sendTransfer(seed, Depth, MinWeightMagnitude, transfers, options, (error, transactions) => {\n  if (error) {\n     console.error('sendTransfer error', error)\n  } else {\n     console.log('transactions sent!', transactions)\n  }\n})\n</code></pre>\n<p>We need to specify where we send our tokens with message to and which of (our) wallets the tokens come from (if we're sending non-zero value). In the response, we get a <code>transaction</code> object for each <code>transfer</code> object we've submitted. </p>\n<p><img src=\"/images/iota/attach-tangle.jpg\" alt=\"Attaching to the IOTA&#x27;s Tangle\"></p>\n<p>If we're lucky, we should be able to get the transaction's <code>hash</code> property, paste it at one of <a href=\"https://thetangle.org\">the online Tangle viewers</a> and see the details of our transaction. It will be most probably in the \"Pending\" state. This means the transaction was properly attached to the Tangle, although it wasn't yet validated by other transactions in the Tangle tree and we need to wait a bit. Normally it gets into \"Confirmed\" state within a few minutes and we can call it a day.</p>\n<p>But we might be not that lucky and our transaction might get attached to the part of the tree that will never be validated, either because there were too many tips in the Tangle tree waiting for validation so that it gets \"forgotten\" by the tip selection algorithm (the tip selection algorithm is biased towards the transactions from the top of the tree) or it happened to get attached to the subtree that yielded incorrect. </p>\n<p>In these cases our transaction never goes away from the \"Pending\" state and we need to fix the problem by \"reattaching\" our transfers (called \"bundle\") to another part of the Tangle tree. In order to do so, we can periodically run the code that might look like:</p>\n<pre><code class=\"language-javascript\">iota.api.getLatestInclusion([hash], (error, inclusionStates) => {\n  if (error) {\n     console.error('getLatestInclusion error', error)\n  } else if (inclusionStates[0]) {\n     console.log('transaction is included (confirmed)! yay!') \n  } else {\n     iota.api.replayBundle(hash, Depth, MinWeightMagnitude, (error, replayTransactions) => {\n         // ad infinitum...?\n     })\n  }\n})\n</code></pre>\n<p>This procedure might look strange, as we're actually adding more and more duplicates to the Tangle - replay transaction is a separate transaction. We now probably need to track the \"inclusion state\" (status) of both the original and the replay transaction. We also need to replay it once again in case it doesn't get validated within a few minutes. All this comes with the cost of issuing a new transaction, but this is actually beneficial to the IOTA network as a whole because by doing this we're confirming another pair of transactions. And there are double-spending validation schemes implemented that ensures only one of the transactions will be finally confirmed.</p>","excerpt":"Previously in the IOTA series we've looked into the assumptions of this promising cryptocurrency system and we've connected to the network…","frontmatter":{"slug":null,"title":"IOTA - Hello World","description":null,"author":"adam","tags":["IOTA","blockchain","cryptocurrency"],"date":"2017-10-29T23:00:00.000Z","image":"/images/iota/attach-tangle.jpg"},"timeToRead":5,"fileAbsolutePath":"/home/runner/work/new-www/new-www/src/mdData/blog/2017-10-30-iota-hello-world.md"},"allMarkdownRemark":{"nodes":[{"frontmatter":{"author_id":"adam","avatar":"/images/members/adam_bar.jpg","bio":"The Web Guy @ Bright Inventions","name":"Adam Bar","web":"https://whatwebcando.today"}},{"frontmatter":{"author_id":"agnieszka_h","avatar":"/images/members/agnieszka_h.jpg","bio":"Sales Manager @ Bright Inventions","name":"Agnieszka Hayashida","web":null}},{"frontmatter":{"author_id":"agnieszka","avatar":"/images/members/agnieszka_olszewska.jpg","bio":"Fullstack developer","name":"Agnieszka Olszewska","web":null}},{"frontmatter":{"author_id":"olo","avatar":"/images/members/aleksander_wielgorski.jpeg","bio":"Software Engineer @ Bright Inventions","name":"Aleksander Wielgórski","web":null}},{"frontmatter":{"author_id":"alisa","avatar":"/images/members/alisa_kashytska.jpg","bio":"Product designer","name":"Alisa Kashytska","web":null}},{"frontmatter":{"author_id":"azabost","avatar":"/images/members/andrzej_zabost.jpg","bio":"Senior Android developer","name":"Andrzej Zabost","web":"https://azabost.com"}},{"frontmatter":{"author_id":"arturs","avatar":"/images/members/artur.jpg","bio":"iOS developer","name":"Artur Suliński","web":null}},{"frontmatter":{"author_id":"bartek k","avatar":"/images/members/bartek_krzyzanski.jpg","bio":"Backend developer","name":"Bartek Krzyżański","web":null}},{"frontmatter":{"author_id":"bartekr","avatar":"/images/members/bartek.jpg","bio":"iOS developer","name":"Bartek Rozwarski","web":null}},{"frontmatter":{"author_id":"bartosz","avatar":"/images/members/bartosz_szafran.jpg","bio":"Senior Frontend Developer","name":"Bartosz Szafran","web":null}},{"frontmatter":{"author_id":"daniel","avatar":"/images/members/daniel_makurat.jpg","bio":"Co-founder & Senior Backend developer","name":"Daniel Makurat","web":null}},{"frontmatter":{"author_id":"eliasz","avatar":"/images/members/eliasz.png","bio":"Software Engineer @ Bright Inventions","name":"Eliasz Sawicki","web":"http://eluss.github.io/"}},{"frontmatter":{"author_id":"fjablonski","avatar":"/images/members/filip_jablonski.jpg","bio":"Senior iOS developer","name":"Filip Jabłoński","web":null}},{"frontmatter":{"author_id":"grzesiek","avatar":"/images/members/grzegorz_ciesla.jpg","bio":"Software Developer","name":"Grzegorz Cieśla","web":null}},{"frontmatter":{"author_id":"ivan","avatar":"/images/members/ivan.jpg","bio":"Fullstack developer","name":"Ivan Menshykov","web":null}},{"frontmatter":{"author_id":"janek","avatar":"/images/members/janhanc.jpg","bio":"Frontend developer","name":"Jan Hanc","web":null}},{"frontmatter":{"author_id":"kwysocki","avatar":"/images/members/kamil.png","bio":"Software Engineer @ Bright Inventions","name":"Kamil Wysocki","web":"https://wysockikamil.com"}},{"frontmatter":{"author_id":"karoln","avatar":"/images/members/karol_nadratowski.jpg","bio":null,"name":"Karol Nadratowski","web":null}},{"frontmatter":{"author_id":"karol r","avatar":"/images/members/karol_rinc.jpg","bio":"Backend developer","name":"Karol Rinc","web":null}},{"frontmatter":{"author_id":"kasia","avatar":"/images/members/kasia_lukasiewicz.jpg","bio":"Senior Project Manager","name":"Kasia Łukasiewicz","web":null}},{"frontmatter":{"author_id":"kasia g","avatar":"/images/members/katarzyna_galka.jpg","bio":"Project manager","name":"Katarzyna Gałka","web":null}},{"frontmatter":{"author_id":"krzysiek h","avatar":"/images/members/krzysztof_hinc.jpg","bio":"Web developer","name":"Krzysiek Hinc","web":null}},{"frontmatter":{"author_id":"krzysiek","avatar":"/images/members/krzysztof_kaczmarek.jpg","bio":"Senior iOS Developer","name":"Krzysztof Kaczmarek","web":null}},{"frontmatter":{"author_id":"maciej","avatar":"/images/members/maciej_seleman.jpg","bio":"QA Specialist","name":"Maciej Seleman","web":null}},{"frontmatter":{"author_id":"magda","avatar":"/images/members/magda_sadowska.jpg","bio":"Office & HR Assistant","name":"Magda Sadowska","web":null}},{"frontmatter":{"author_id":"maja","avatar":"/images/members/maja_puta.jpg","bio":"Junior QA Specialist","name":"Maja Puta","web":null}},{"frontmatter":{"author_id":"marcink","avatar":"/images/members/marcin_kwiatkowski.jpg","bio":null,"name":"Marcin Kwiatkowski","web":null}},{"frontmatter":{"author_id":"mateusz","avatar":"/images/members/mateusz_klimczak.jpg","bio":"Technical leader & Project manager","name":"Mateusz Klimczak","web":null}},{"frontmatter":{"author_id":"mateuszklimek","avatar":"/images/members/mateuszklimek.png","bio":"Software Engineer @ Bright Inventions","name":"Mateusz Klimek","web":null}},{"frontmatter":{"author_id":"michal k","avatar":"/images/members/michal_koszalka.jpg","bio":"Senior Backend developer","name":"Michał Koszałka","web":null}},{"frontmatter":{"author_id":"michał","avatar":"/images/members/michal_wrobel.jpg","bio":"Senior Backend Developer at Bright Inventions","name":"Michał Wróbel","web":null}},{"frontmatter":{"author_id":"michal","avatar":"/images/members/michał_łukasiewicz.jpg","bio":"Co-founder & Senior iOS developer","name":"Michał Łukasiewicz","web":null}},{"frontmatter":{"author_id":"monika","avatar":"/images/members/monika.jpg","bio":"Software Developer @ Bright Inventions","name":"Monika Niegrzybowska","web":null}},{"frontmatter":{"author_id":"nikodem","avatar":"/images/members/nikodem_kalinowski.jpg","bio":"Web developer","name":"Nikodem Kalinowski","web":null}},{"frontmatter":{"author_id":"patryk","avatar":"/images/members/patryk_huzarski.jpg","bio":"Software Developer @ Bright Inventions","name":"Patryk Huzarski","web":null}},{"frontmatter":{"author_id":"patryk sz","avatar":"/images/members/patryk_szlagowski.jpg","bio":"Senior Backend developer","name":"Patryk Szlagowski","web":null}},{"frontmatter":{"author_id":"paweł","avatar":"/images/members/paweł_gutkowski.jpg","bio":"Fullstack Developer at Bright Inventions ","name":"Paweł Gutkowski","web":null}},{"frontmatter":{"author_id":"pawel","avatar":"/images/members/paweł_papkiewicz.jpg","bio":"Fullstack developer","name":"Paweł Papkiewicz","web":null}},{"frontmatter":{"author_id":"piotr","avatar":"/images/members/piotr_mionskowski.jpg","bio":"TDD fan eager to learn new things","name":"Piotr Mionskowski","web":"https://miensol.pl"}},{"frontmatter":{"author_id":"piotr_l","avatar":"/images/members/piotrl.png","bio":"Android Developer @ Bright Inventions","name":"Piotr Łupiński","web":"http://exp.flamaster2.com"}},{"frontmatter":{"author_id":"radek","avatar":"/images/members/radek_pieczątkiewicz.jpg","bio":"Android developer","name":"Radek Pieczątkiewicz","web":null}},{"frontmatter":{"author_id":"radeks","avatar":"/images/members/radoslaw.jpg","bio":"Software Engineer @ Bright Inventions","name":"Radosław Słowiński","web":null}},{"frontmatter":{"author_id":"rafal h","avatar":"/images/members/rafal_hoffman.jpg","bio":"Fullstack developer","name":"Rafał Hofman","web":null}},{"frontmatter":{"author_id":"sebastian","avatar":"/images/members/sebastian_sobczak.jpg","bio":"Junior Account Manager at Bright Inventions ","name":"Sebastian Sobczak","web":null}},{"frontmatter":{"author_id":"szymek","avatar":"/images/members/szymon_miloch.jpg","bio":"Android & Web developer","name":"Szymon Miloch","web":null}},{"frontmatter":{"author_id":"tomek","avatar":"/images/members/tomek.jpeg","bio":null,"name":"Tomasz Gęsior","web":null}},{"frontmatter":{"author_id":"ula","avatar":"/images/members/ula_stankiewicz.jpg","bio":"HR & Marketing Manager","name":"Ula Stankiewicz","web":null}},{"frontmatter":{"author_id":"wojciech","avatar":"/images/members/wojciech_baczyński.jpg","bio":"Fullstack developer","name":"Wojciech Baczyński","web":null}},{"frontmatter":{"author_id":"lukasz","avatar":"/images/members/lukasz_reszetow.jpg","bio":"Android developer","name":"Łukasz Reszetow","web":null}}]},"site":{"siteMetadata":{"siteUrl":"https://brightinventions.pl"}}},"pageContext":{"fileAbsolutePath":"/home/runner/work/new-www/new-www/src/mdData/blog/2017-10-30-iota-hello-world.md"}}}