{"componentChunkName":"component---src-templates-post-template-tsx","path":"/blog/android-manifest-placeholders","result":{"data":{"markdownRemark":{"html":"<h1>What are they?</h1>\n<p><a href=\"https://developer.android.com/studio/build/manifest-build-variables.html\">Android Manifest placeholders</a> allow you to put variables into the Manifest that is otherwise completely static. Why would you need such functionality? Actually, it depends on your projects. It's probably most useful when you have multiple <a href=\"https://developer.android.com/studio/build/build-variants.html\">build variants</a> with different Manifest configurations.</p>\n<h1>Multiple Manifests</h1>\n<p>Of course, the easiest way to configure Manifest per build variant is to place a separate <code>AndroidManifest.xml</code> file in the variant-specific source directory. For example let's say we have an <code>app</code> module with <a href=\"https://developer.android.com/studio/build/build-variants.html#flavor-dimensions\">flavor dimension</a> called <code>features</code> with two flavors: <code>paid</code> and <code>free</code>. In Gradle file it could look like this:</p>\n<pre><code class=\"language-groovy\">android {\n    ...\n    buildTypes {\n        release {...}\n        debug {...}\n    }\n\n    flavorDimensions \"features\"\n\n    productFlavors {\n        paid {\n            dimension \"features\"\n            ...\n        }\n        free {\n            dimension \"features\"\n            ...\n        }\n    }\n}\n</code></pre>\n<p>This enables us to use different source sets, including Manifest files. If we would like to separate <code>paid</code> and <code>free</code> configurations, we could place different Manifests in the following project directories:</p>\n<ul>\n<li><code>app/src/paid/AndroidManifest.xml</code></li>\n<li><code>app/src/free/AndroidManifest.xml</code></li>\n</ul>\n<p>We could also use fully qualified build variants (combining product flavors with build types):</p>\n<ul>\n<li><code>app/src/paidDebug/AndroidManifest.xml</code></li>\n<li><code>app/src/paidRelease/AndroidManifest.xml</code></li>\n<li><code>app/src/freeDebug/AndroidManifest.xml</code></li>\n<li><code>app/src/freeRelease/AndroidManifest.xml</code></li>\n</ul>\n<p><em>Note #1: Source sets are not created automatically. You can create them by hand or using <strong>Source set</strong> dropdown menu while creating a new file or directory in Android Studio.</em></p>\n<p><em>Note #2: If you would like to make sure how to organize the source sets, you can run Gradle <code>sourceSets</code> task, e.g. with <code>./gradlew sourceSets</code> or Android Studio Gradle menu.</em></p>\n<p>While using multiple Manifest files gives the best flexibility (you can change literally everything), the maintenance may be troublesome for several reasons, e.g.:</p>\n<ul>\n<li>changing anything requires editing every file,</li>\n<li>comparing multiple files and finding differences is not convenient.</li>\n</ul>\n<p><img src=\"/images/android-manifest-placeholders/placeholder.png\" alt=\"Placeholder\">{: .center-image}</p>\n<h1>Using placeholders</h1>\n<p>So instead of using multiple files I always strive to use some variables. In order to use a variable in the Manifest we must specify it in the <code>manifestPlaceholders</code> property in Gradle. We can do this in several places, e.g.:</p>\n<ul>\n<li>default config</li>\n</ul>\n<pre><code class=\"language-groovy\">android {\n    ...\n    defaultConfig {\n        manifestPlaceholders.screenOrientation = \"unspecified\"\n    }\n}\n</code></pre>\n<ul>\n<li>product flavor</li>\n</ul>\n<pre><code class=\"language-groovy\">android {\n    ...\n    flavorDimensions \"features\"\n\n    productFlavors {\n        paid {\n            dimension \"features\"\n            manifestPlaceholders.hostName = \"www.paid-example.com\"\n        }\n        free {\n            dimension \"features\"\n            manifestPlaceholders.hostName = \"www.free-example.com\"\n        }\n    }\n}\n</code></pre>\n<ul>\n<li>build type</li>\n</ul>\n<pre><code class=\"language-groovy\">android {\n    ...\n    buildTypes {\n        release {\n            ...\n            manifestPlaceholders.screenOrientation = \"portrait\"\n        }\n        debug {...}\n    }\n}\n</code></pre>\n<p><em>Note #1: <code>manifestPlaceholders</code> object is just a <code>Map&#x3C;String, Object></code> so you can also use its other methods like <code>containsKey()</code> etc.</em></p>\n<p><em>Note #2: You can also specify all the values at once by assigning a map like this: <code>manifestPlaceholders = [...]</code></em></p>\n<p>Then we can use the variables in the Manifest simply by putting the variable name in curly brackets and using a dollar sign like this:</p>\n<pre><code class=\"language-xml\">&#x3C;activity\n    android:name=\".MyActivity\"\n    android:screenOrientation=\"${screenOrientation}\" />\n</code></pre>\n<h1>Applications</h1>\n<p>I've come across a few common usages of the placeholders, e.g.:</p>\n<ul>\n<li>enabling/disabling <a href=\"https://developer.android.com/guide/components/.html\">application components</a> and meta-data, including the ones that come with your app's dependencies</li>\n</ul>\n<pre><code class=\"language-xml\">&#x3C;service\n    android:name=\".firebase.FcmIdService\"\n    android:enabled=\"${pushNotifications}\">\n    ...\n&#x3C;/service>\n\n&#x3C;provider\n    android:name=\"android.support.v4.content.FileProvider\"\n    android:authorities=\"${fileProvider}\"\n    ... >\n    ...\n&#x3C;/provider>\n</code></pre>\n<ul>\n<li>overriding screen orientation in portrait-only apps so that you can rotate it in debug builds which may be useful when looking for lifecycle related memory leaks</li>\n</ul>\n<pre><code class=\"language-xml\">&#x3C;activity\n    android:name=\".MyActivity\"\n    android:screenOrientation=\"${screenOrientation}\" />\n</code></pre>\n<ul>\n<li>using different deep links configuration</li>\n</ul>\n<pre><code class=\"language-xml\">&#x3C;intent-filter>\n    &#x3C;action android:name=\"android.intent.action.VIEW\"/>\n    &#x3C;category android:name=\"android.intent.category.DEFAULT\"/>\n    &#x3C;category android:name=\"android.intent.category.BROWSABLE\"/>\n    &#x3C;data android:scheme=\"app\" android:host=\"${deepLinkHost}\" />\n&#x3C;/intent-filter>\n</code></pre>\n<ul>\n<li>removing <code>SYSTEM_ALERT_WINDOW</code> permission from React Native based release builds (this seems quite hacky though; you can find the original issue <a href=\"https://stackoverflow.com/questions/45170025/cant-use-manifest-placeholders-to-remove-a-permission\">here (link)</a>)</li>\n</ul>\n<pre><code class=\"language-xml\">&#x3C;uses-permission android:name=\"${excludeDebugPermissionName}\" tools:node=\"remove\" />\n</code></pre>\n<pre><code class=\"language-groovy\">buildTypes {\n    release {\n        ...\n        manifestPlaceholders.excludeDebugPermissionName = \"android.permission.SYSTEM_ALERT_WINDOW\"\n    }\n    debug {\n        ...\n        manifestPlaceholders.excludeDebugPermissionName = \"fake.name\"\n    }\n}\n</code></pre>\n<p>But there are much more possibilities, e.g. I can think of an app that uses different launcher activities.</p>\n<p>Do you have any interesting experiences using the placeholders? Feel free to share with me in the comments :-)</p>","excerpt":"What are they? Android Manifest placeholders allow you to put variables into the Manifest that is otherwise completely static. Why would you…","frontmatter":{"slug":null,"title":"Android Manifest placeholders","description":null,"author":"azabost","tags":["android","gradle","manifest"],"date":"2018-01-24T23:00:00.000Z","image":"/images/android-manifest-placeholders/placeholder.png"},"timeToRead":4,"fileAbsolutePath":"/home/runner/work/new-www/new-www/src/mdData/blog/2018-01-25-android-manifest-placeholders.md"},"allMarkdownRemark":{"nodes":[{"frontmatter":{"author_id":"adam","avatar":"/images/members/adam_bar.jpg","bio":"The Web Guy @ Bright Inventions","name":"Adam Bar","web":"https://whatwebcando.today"}},{"frontmatter":{"author_id":"agnieszka_h","avatar":"/images/members/agnieszka_h.jpg","bio":"Sales Manager @ Bright Inventions","name":"Agnieszka Hayashida","web":null}},{"frontmatter":{"author_id":"agnieszka","avatar":"/images/members/agnieszka_olszewska.jpg","bio":"Fullstack developer","name":"Agnieszka Olszewska","web":null}},{"frontmatter":{"author_id":"olo","avatar":"/images/members/aleksander_wielgorski.jpeg","bio":"Software Engineer @ Bright Inventions","name":"Aleksander Wielgórski","web":null}},{"frontmatter":{"author_id":"alisa","avatar":"/images/members/alisa_kashytska.jpg","bio":"Product designer","name":"Alisa Kashytska","web":null}},{"frontmatter":{"author_id":"azabost","avatar":"/images/members/andrzej_zabost.jpg","bio":"Senior Android developer","name":"Andrzej Zabost","web":"https://azabost.com"}},{"frontmatter":{"author_id":"arturs","avatar":"/images/members/artur.jpg","bio":"iOS developer","name":"Artur Suliński","web":null}},{"frontmatter":{"author_id":"bartek k","avatar":"/images/members/bartek_krzyzanski.jpg","bio":"Backend developer","name":"Bartek Krzyżański","web":null}},{"frontmatter":{"author_id":"bartekr","avatar":"/images/members/bartek.jpg","bio":"iOS developer","name":"Bartek Rozwarski","web":null}},{"frontmatter":{"author_id":"bartosz","avatar":"/images/members/bartosz_szafran.jpg","bio":"Senior Frontend Developer","name":"Bartosz Szafran","web":null}},{"frontmatter":{"author_id":"daniel","avatar":"/images/members/daniel_makurat.jpg","bio":"Co-founder & Senior Backend developer","name":"Daniel Makurat","web":null}},{"frontmatter":{"author_id":"eliasz","avatar":"/images/members/eliasz.png","bio":"Software Engineer @ Bright Inventions","name":"Eliasz Sawicki","web":"http://eluss.github.io/"}},{"frontmatter":{"author_id":"fjablonski","avatar":"/images/members/filip_jablonski.jpg","bio":"Senior iOS developer","name":"Filip Jabłoński","web":null}},{"frontmatter":{"author_id":"grzesiek","avatar":"/images/members/grzegorz_ciesla.jpg","bio":"Software Developer","name":"Grzegorz Cieśla","web":null}},{"frontmatter":{"author_id":"ivan","avatar":"/images/members/ivan.jpg","bio":"Fullstack developer","name":"Ivan Menshykov","web":null}},{"frontmatter":{"author_id":"janek","avatar":"/images/members/janhanc.jpg","bio":"Frontend developer","name":"Jan Hanc","web":null}},{"frontmatter":{"author_id":"kwysocki","avatar":"/images/members/kamil.png","bio":"Software Engineer @ Bright Inventions","name":"Kamil Wysocki","web":"https://wysockikamil.com"}},{"frontmatter":{"author_id":"karoln","avatar":"/images/members/karol_nadratowski.jpg","bio":null,"name":"Karol Nadratowski","web":null}},{"frontmatter":{"author_id":"karol r","avatar":"/images/members/karol_rinc.jpg","bio":"Backend developer","name":"Karol Rinc","web":null}},{"frontmatter":{"author_id":"kasia","avatar":"/images/members/kasia_lukasiewicz.jpg","bio":"Senior Project Manager","name":"Kasia Łukasiewicz","web":null}},{"frontmatter":{"author_id":"kasia g","avatar":"/images/members/katarzyna_galka.jpg","bio":"Project manager","name":"Katarzyna Gałka","web":null}},{"frontmatter":{"author_id":"krzysiek h","avatar":"/images/members/krzysztof_hinc.jpg","bio":"Web developer","name":"Krzysiek Hinc","web":null}},{"frontmatter":{"author_id":"krzysiek","avatar":"/images/members/krzysztof_kaczmarek.jpg","bio":"Senior iOS Developer","name":"Krzysztof Kaczmarek","web":null}},{"frontmatter":{"author_id":"maciej","avatar":"/images/members/maciej_seleman.jpg","bio":"QA Specialist","name":"Maciej Seleman","web":null}},{"frontmatter":{"author_id":"magda","avatar":"/images/members/magda_sadowska.jpg","bio":"Office & HR Assistant","name":"Magda Sadowska","web":null}},{"frontmatter":{"author_id":"maja","avatar":"/images/members/maja_puta.jpg","bio":"Junior QA Specialist","name":"Maja Puta","web":null}},{"frontmatter":{"author_id":"marcink","avatar":"/images/members/marcin_kwiatkowski.jpg","bio":null,"name":"Marcin Kwiatkowski","web":null}},{"frontmatter":{"author_id":"mateusz","avatar":"/images/members/mateusz_klimczak.jpg","bio":"Technical leader & Project manager","name":"Mateusz Klimczak","web":null}},{"frontmatter":{"author_id":"mateuszklimek","avatar":"/images/members/mateuszklimek.png","bio":"Software Engineer @ Bright Inventions","name":"Mateusz Klimek","web":null}},{"frontmatter":{"author_id":"michal k","avatar":"/images/members/michal_koszalka.jpg","bio":"Senior Backend developer","name":"Michał Koszałka","web":null}},{"frontmatter":{"author_id":"michał","avatar":"/images/members/michal_wrobel.jpg","bio":"Senior Backend Developer at Bright Inventions","name":"Michał Wróbel","web":null}},{"frontmatter":{"author_id":"michal","avatar":"/images/members/michał_łukasiewicz.jpg","bio":"Co-founder & Senior iOS developer","name":"Michał Łukasiewicz","web":null}},{"frontmatter":{"author_id":"monika","avatar":"/images/members/monika.jpg","bio":"Software Developer @ Bright Inventions","name":"Monika Niegrzybowska","web":null}},{"frontmatter":{"author_id":"nikodem","avatar":"/images/members/nikodem_kalinowski.jpg","bio":"Web developer","name":"Nikodem Kalinowski","web":null}},{"frontmatter":{"author_id":"patryk","avatar":"/images/members/patryk_huzarski.jpg","bio":"Software Developer @ Bright Inventions","name":"Patryk Huzarski","web":null}},{"frontmatter":{"author_id":"patryk sz","avatar":"/images/members/patryk_szlagowski.jpg","bio":"Senior Backend developer","name":"Patryk Szlagowski","web":null}},{"frontmatter":{"author_id":"paweł","avatar":"/images/members/paweł_gutkowski.jpg","bio":"Fullstack Developer at Bright Inventions ","name":"Paweł Gutkowski","web":null}},{"frontmatter":{"author_id":"pawel","avatar":"/images/members/paweł_papkiewicz.jpg","bio":"Fullstack developer","name":"Paweł Papkiewicz","web":null}},{"frontmatter":{"author_id":"piotr","avatar":"/images/members/piotr_mionskowski.jpg","bio":"TDD fan eager to learn new things","name":"Piotr Mionskowski","web":"https://miensol.pl"}},{"frontmatter":{"author_id":"piotr_l","avatar":"/images/members/piotrl.png","bio":"Android Developer @ Bright Inventions","name":"Piotr Łupiński","web":"http://exp.flamaster2.com"}},{"frontmatter":{"author_id":"radek","avatar":"/images/members/radek_pieczątkiewicz.jpg","bio":"Android developer","name":"Radek Pieczątkiewicz","web":null}},{"frontmatter":{"author_id":"radeks","avatar":"/images/members/radoslaw.jpg","bio":"Software Engineer @ Bright Inventions","name":"Radosław Słowiński","web":null}},{"frontmatter":{"author_id":"rafal h","avatar":"/images/members/rafal_hoffman.jpg","bio":"Fullstack developer","name":"Rafał Hofman","web":null}},{"frontmatter":{"author_id":"sebastian","avatar":"/images/members/sebastian_sobczak.jpg","bio":"Junior Account Manager at Bright Inventions ","name":"Sebastian Sobczak","web":null}},{"frontmatter":{"author_id":"szymek","avatar":"/images/members/szymon_miloch.jpg","bio":"Android & Web developer","name":"Szymon Miloch","web":null}},{"frontmatter":{"author_id":"tomek","avatar":"/images/members/tomek.jpeg","bio":null,"name":"Tomasz Gęsior","web":null}},{"frontmatter":{"author_id":"ula","avatar":"/images/members/ula_stankiewicz.jpg","bio":"HR & Marketing Manager","name":"Ula Stankiewicz","web":null}},{"frontmatter":{"author_id":"wojciech","avatar":"/images/members/wojciech_baczyński.jpg","bio":"Fullstack developer","name":"Wojciech Baczyński","web":null}},{"frontmatter":{"author_id":"lukasz","avatar":"/images/members/lukasz_reszetow.jpg","bio":"Android developer","name":"Łukasz Reszetow","web":null}}]},"site":{"siteMetadata":{"siteUrl":"https://brightinventions.pl"}}},"pageContext":{"fileAbsolutePath":"/home/runner/work/new-www/new-www/src/mdData/blog/2018-01-25-android-manifest-placeholders.md"}}}