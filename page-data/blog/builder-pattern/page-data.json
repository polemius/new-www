{"componentChunkName":"component---src-templates-post-template-tsx","path":"/blog/builder-pattern","result":{"data":{"markdownRemark":{"html":"<p>Builder pattern might be used in regular code, but I personally find it the most useful in tests. This is where you need to create objects which on one hand need to meet certain circumstances and on the other hand  you do not want to be bothered with other parameters. The builder pattern is the answer.</p>\n<p><img src=\"/images/builder-pattern-in-kotlin/builder.jpeg\" alt=\"Image\">{: .center-image}</p>\n<p>Let’s jump straight to a code example. We have a basic class representing a person that can have a number of friends.</p>\n<pre><code class=\"language-kotlin\">class Person (var name: String,\n    var surname: String,\n    var age: Int,\n    var gender: Gender,\n    var friends: Array&#x3C;Person>)\n</code></pre>\n<p>There is also an enum:</p>\n<pre><code class=\"language-kotlin\">enum Gender {\n    Male,\n    Female\n}\n</code></pre>\n<p>Now we will create the builder class. First of all we need a private field for every field of our Person class together with a meaningful and valid default value.</p>\n<pre><code class=\"language-kotlin\">class PersonBuilder {\n    private var name: String = \"John\",\n    private var surname: String = \"Doe\",\n    private var age: Int = 21\n    private var gender: Gender = Gender.Mail,\n    private var friends: MutableArray&#x3C;Person> = mutableArrayOf()\n}\n</code></pre>\n<p>Now we need a method for each parameter to make possible to overwrite it. Each method is returning <code>this</code> so that we can chain the methods and therefore achieve the fluent interface. </p>\n<pre><code class=\"language-kotlin\">fun withName(name: String) {\n    this.name = name\n    return this\n}\n</code></pre>\n<p>To get the actual object we need to have one more method - the <code>build</code> method.</p>\n<pre><code class=\"language-kotlin\">fun build() : Person = Person(name, surname, age, gender, friends.toTypedArray())\n</code></pre>\n<p>We can use our builder class in a test method.</p>\n<pre><code class=\"language-kotlin\">val person = PersonBuilder()\n    .withName(\"Jane\")\n    .withGender(Gender.Female)\n    .build()\n</code></pre>\n<p>In the test methods I often need just one element in the array, so I find it useful to create another method which allows for adding a single person to the array:</p>\n<pre><code class=\"language-kotlin\">fun withFriend(friend: Person) : PersonBuilder {\n    this.friends.add(friend)\n    return this\n}\n</code></pre>\n<p>Another great thing you can use along with the builder pattern are domain specific methods. Say you need an under-aged person for your tests. You could just pass the age of say 15 into the <code>withAge</code> method:</p>\n<pre><code class=\"language-kotlin\">val underAgedPerson = PersonBuilder().whitAge(15).build()\n</code></pre>\n<p>Does it clearly show the purpose? Not really. This is a kind of a magic number. Let’s add two more methods to our builder class:</p>\n<pre><code class=\"language-kotlin\">fun withAgeOfMaturity() {\n    this.age = 19\n    return this\n}\nfun withAgeOfUnderAged() {\n    this.age = 15\n    return this\n}\n</code></pre>\n<p>And now we can use it as so:</p>\n<pre><code class=\"language-kotlin\">val underAgedPerson = PersonBuilder().withAgeOfUnderAged().build()\n</code></pre>\n<p>Another typical case is when you need a set of parameter values mixed together to create a meaningful object. Say you want to create a woman person - not only do you want to set the gender but also add some feminine name.</p>\n<pre><code class=\"language-kotlin\">val woman = PersonBuilder().withGender(Gender.Female).withName(\"Jane\").build()\n</code></pre>\n<p>You can add a <code>build</code> method for this purpose:</p>\n<pre><code class=\"language-kotlin\">fun buildWoman() : Person = Person(\"Jane\", surname, age, Gender.Female, friends.toTypedArray())\n</code></pre>\n<p>Creating another <code>build</code> method for every case you can think of is a waste of time and energy. There are two main conditions to be met to decide that you need a specific <code>build</code> method:</p>\n<ul>\n<li>a set of values tend to repeat in your tests,</li>\n<li>the set of values together create a specific domain object.</li>\n</ul>\n<p>You will know the second condition is met if you can name the <code>build</code> method with the domain specific language :)</p>\n<p><strong>Koltin Named And Default Arguments</strong></p>\n<p>There is another approach I’ve come along recently which made me realize I was using Java approach poorly adapted in Kotlin. You can make a great use of Kotlin default arguments as well as named arguments in the constructor. You can read the whole story <a href=\"https://praveer09.github.io/technology/2015/12/26/writing-test-data-builders-made-easy-with-kotlin\">here</a> or move on to an example.</p>\n<p>Instead of writing each <code>with</code> method you just declare the private fields as optional constructor parameters. The <code>build</code> method stays the same as before.</p>\n<pre><code class=\"language-kotlin\">class PersonBuilder (\n    var name: String = “John”,\n    var surname: String = “Doe”,\n    var age: Int = 21\n    var gender: Gender = Gender.Mail,\n    var friends: MutableArray&#x3C;Person> = mutableArrayOf()) {\n    \n    fun build() : Person = Person(name, surname, age, gender, friends.toTypedArray())\n}\n</code></pre>\n<p>In the forementioned blog post, the author uses immutable properties. However, if we use mutable ones, we can still make use of the additional domain specific methods. This is how the builder class looks now:</p>\n<pre><code class=\"language-kotlin\">class PersonBuilder (var name: String = \"John\",\n    var surname: String = \"Doe\",\n    var age: Int = 21\n    var gender: Gender = Gender.Mail,\n    var friends: MutableArray&#x3C;Person> = mutableArrayOf()) {\n    \n    fun build() : Person = Person(name, surname, age, gender, friends.toTypedArray())\n    \n    fun buildWoman() : Person = Person(\"Jane\", surname, age, Gender.Female, friends.toTypedArray())\n    \n    fun withFriend(friend: Person) : PersonBuilder {\n        this.friends.add(friend)\n        return this\n    }\n\n    fun withAgeOfMaturity() : PersonBuilder {\n        this.age = 19\n        return this\n    }\n    \n    fun withAgeUnderAged() : PersonBuilder {\n        this.age = 15\n        return this\n    }\n}\n</code></pre>\n<p>And this is how we can use it in tests:</p>\n<pre><code class=\"language-kotlin\">val underAgedPerson = PersonBuilder(name = \"Mickey\").withAgeUnderAged().build()\nval woman = PersonBuilder(surname = \"Smith\").buildWoman()\n</code></pre>\n<p><strong>Summary</strong></p>\n<p>Although I am an enthusiast of TDD and clearly see all the advantages of this approach, sometimes it feels really tempting to ignore the tests and go straight to coding. The more convenient tests are, the more willing you are to write them. The builder pattern is an example of what makes the tests easier to write. And easier to read, which after all might be even more important :)</p>","excerpt":"Builder pattern might be used in regular code, but I personally find it the most useful in tests. This is where you need to create objects…","frontmatter":{"slug":null,"title":"Builder pattern in Kotlin","description":null,"author":"agnieszka","tags":["kotlin","builder","pattern"],"date":"2018-01-16T23:00:00.000Z","image":"/images/builder-pattern-in-kotlin/builder.jpeg"},"timeToRead":4,"fileAbsolutePath":"/home/runner/work/new-www/new-www/src/mdData/blog/2018-01-17-builder-pattern.md"},"allMarkdownRemark":{"nodes":[{"frontmatter":{"author_id":"adam","avatar":"/images/members/adam_bar.jpg","bio":"The Web Guy @ Bright Inventions","name":"Adam Bar","web":"https://whatwebcando.today"}},{"frontmatter":{"author_id":"agnieszka_h","avatar":"/images/members/agnieszka_h.jpg","bio":"Sales Manager @ Bright Inventions","name":"Agnieszka Hayashida","web":null}},{"frontmatter":{"author_id":"agnieszka","avatar":"/images/members/agnieszka_olszewska.jpg","bio":"Fullstack developer","name":"Agnieszka Olszewska","web":null}},{"frontmatter":{"author_id":"olo","avatar":"/images/members/aleksander_wielgorski.jpeg","bio":"Software Engineer @ Bright Inventions","name":"Aleksander Wielgórski","web":null}},{"frontmatter":{"author_id":"alisa","avatar":"/images/members/alisa_kashytska.jpg","bio":"Product designer","name":"Alisa Kashytska","web":null}},{"frontmatter":{"author_id":"azabost","avatar":"/images/members/andrzej_zabost.jpg","bio":"Senior Android developer","name":"Andrzej Zabost","web":"https://azabost.com"}},{"frontmatter":{"author_id":"arturs","avatar":"/images/members/artur.jpg","bio":"iOS developer","name":"Artur Suliński","web":null}},{"frontmatter":{"author_id":"bartek k","avatar":"/images/members/bartek_krzyzanski.jpg","bio":"Backend developer","name":"Bartek Krzyżański","web":null}},{"frontmatter":{"author_id":"bartekr","avatar":"/images/members/bartek.jpg","bio":"iOS developer","name":"Bartek Rozwarski","web":null}},{"frontmatter":{"author_id":"bartosz","avatar":"/images/members/bartosz_szafran.jpg","bio":"Senior Frontend Developer","name":"Bartosz Szafran","web":null}},{"frontmatter":{"author_id":"daniel","avatar":"/images/members/daniel_makurat.jpg","bio":"Co-founder & Senior Backend developer","name":"Daniel Makurat","web":null}},{"frontmatter":{"author_id":"eliasz","avatar":"/images/members/eliasz.png","bio":"Software Engineer @ Bright Inventions","name":"Eliasz Sawicki","web":"http://eluss.github.io/"}},{"frontmatter":{"author_id":"fjablonski","avatar":"/images/members/filip_jablonski.jpg","bio":"Senior iOS developer","name":"Filip Jabłoński","web":null}},{"frontmatter":{"author_id":"grzesiek","avatar":"/images/members/grzegorz_ciesla.jpg","bio":"Software Developer","name":"Grzegorz Cieśla","web":null}},{"frontmatter":{"author_id":"ivan","avatar":"/images/members/ivan.jpg","bio":"Fullstack developer","name":"Ivan Menshykov","web":null}},{"frontmatter":{"author_id":"janek","avatar":"/images/members/janhanc.jpg","bio":"Frontend developer","name":"Jan Hanc","web":null}},{"frontmatter":{"author_id":"kwysocki","avatar":"/images/members/kamil.png","bio":"Software Engineer @ Bright Inventions","name":"Kamil Wysocki","web":"https://wysockikamil.com"}},{"frontmatter":{"author_id":"karoln","avatar":"/images/members/karol_nadratowski.jpg","bio":null,"name":"Karol Nadratowski","web":null}},{"frontmatter":{"author_id":"karol r","avatar":"/images/members/karol_rinc.jpg","bio":"Backend developer","name":"Karol Rinc","web":null}},{"frontmatter":{"author_id":"kasia","avatar":"/images/members/kasia_lukasiewicz.jpg","bio":"Senior Project Manager","name":"Kasia Łukasiewicz","web":null}},{"frontmatter":{"author_id":"kasia g","avatar":"/images/members/katarzyna_galka.jpg","bio":"Project manager","name":"Katarzyna Gałka","web":null}},{"frontmatter":{"author_id":"krzysiek h","avatar":"/images/members/krzysztof_hinc.jpg","bio":"Web developer","name":"Krzysiek Hinc","web":null}},{"frontmatter":{"author_id":"krzysiek","avatar":"/images/members/krzysztof_kaczmarek.jpg","bio":"Senior iOS Developer","name":"Krzysztof Kaczmarek","web":null}},{"frontmatter":{"author_id":"maciej","avatar":"/images/members/maciej_seleman.jpg","bio":"QA Specialist","name":"Maciej Seleman","web":null}},{"frontmatter":{"author_id":"magda","avatar":"/images/members/magda_sadowska.jpg","bio":"Office & HR Assistant","name":"Magda Sadowska","web":null}},{"frontmatter":{"author_id":"maja","avatar":"/images/members/maja_puta.jpg","bio":"Junior QA Specialist","name":"Maja Puta","web":null}},{"frontmatter":{"author_id":"marcink","avatar":"/images/members/marcin_kwiatkowski.jpg","bio":null,"name":"Marcin Kwiatkowski","web":null}},{"frontmatter":{"author_id":"mateusz","avatar":"/images/members/mateusz_klimczak.jpg","bio":"Technical leader & Project manager","name":"Mateusz Klimczak","web":null}},{"frontmatter":{"author_id":"mateuszklimek","avatar":"/images/members/mateuszklimek.png","bio":"Software Engineer @ Bright Inventions","name":"Mateusz Klimek","web":null}},{"frontmatter":{"author_id":"michal k","avatar":"/images/members/michal_koszalka.jpg","bio":"Senior Backend developer","name":"Michał Koszałka","web":null}},{"frontmatter":{"author_id":"michał","avatar":"/images/members/michal_wrobel.jpg","bio":"Senior Backend Developer at Bright Inventions","name":"Michał Wróbel","web":null}},{"frontmatter":{"author_id":"michal","avatar":"/images/members/michał_łukasiewicz.jpg","bio":"Co-founder & Senior iOS developer","name":"Michał Łukasiewicz","web":null}},{"frontmatter":{"author_id":"monika","avatar":"/images/members/monika.jpg","bio":"Software Developer @ Bright Inventions","name":"Monika Niegrzybowska","web":null}},{"frontmatter":{"author_id":"nikodem","avatar":"/images/members/nikodem_kalinowski.jpg","bio":"Web developer","name":"Nikodem Kalinowski","web":null}},{"frontmatter":{"author_id":"patryk","avatar":"/images/members/patryk_huzarski.jpg","bio":"Software Developer @ Bright Inventions","name":"Patryk Huzarski","web":null}},{"frontmatter":{"author_id":"patryk sz","avatar":"/images/members/patryk_szlagowski.jpg","bio":"Senior Backend developer","name":"Patryk Szlagowski","web":null}},{"frontmatter":{"author_id":"paweł","avatar":"/images/members/paweł_gutkowski.jpg","bio":"Fullstack Developer at Bright Inventions ","name":"Paweł Gutkowski","web":null}},{"frontmatter":{"author_id":"pawel","avatar":"/images/members/paweł_papkiewicz.jpg","bio":"Fullstack developer","name":"Paweł Papkiewicz","web":null}},{"frontmatter":{"author_id":"piotr","avatar":"/images/members/piotr_mionskowski.jpg","bio":"TDD fan eager to learn new things","name":"Piotr Mionskowski","web":"https://miensol.pl"}},{"frontmatter":{"author_id":"piotr_l","avatar":"/images/members/piotrl.png","bio":"Android Developer @ Bright Inventions","name":"Piotr Łupiński","web":"http://exp.flamaster2.com"}},{"frontmatter":{"author_id":"radek","avatar":"/images/members/radek_pieczątkiewicz.jpg","bio":"Android developer","name":"Radek Pieczątkiewicz","web":null}},{"frontmatter":{"author_id":"radeks","avatar":"/images/members/radoslaw.jpg","bio":"Software Engineer @ Bright Inventions","name":"Radosław Słowiński","web":null}},{"frontmatter":{"author_id":"rafal h","avatar":"/images/members/rafal_hoffman.jpg","bio":"Fullstack developer","name":"Rafał Hofman","web":null}},{"frontmatter":{"author_id":"sebastian","avatar":"/images/members/sebastian_sobczak.jpg","bio":"Junior Account Manager at Bright Inventions ","name":"Sebastian Sobczak","web":null}},{"frontmatter":{"author_id":"szymek","avatar":"/images/members/szymon_miloch.jpg","bio":"Android & Web developer","name":"Szymon Miloch","web":null}},{"frontmatter":{"author_id":"tomek","avatar":"/images/members/tomek.jpeg","bio":null,"name":"Tomasz Gęsior","web":null}},{"frontmatter":{"author_id":"ula","avatar":"/images/members/ula_stankiewicz.jpg","bio":"HR & Marketing Manager","name":"Ula Stankiewicz","web":null}},{"frontmatter":{"author_id":"wojciech","avatar":"/images/members/wojciech_baczyński.jpg","bio":"Fullstack developer","name":"Wojciech Baczyński","web":null}},{"frontmatter":{"author_id":"lukasz","avatar":"/images/members/lukasz_reszetow.jpg","bio":"Android developer","name":"Łukasz Reszetow","web":null}}]},"site":{"siteMetadata":{"siteUrl":"https://brightinventions.pl"}}},"pageContext":{"fileAbsolutePath":"/home/runner/work/new-www/new-www/src/mdData/blog/2018-01-17-builder-pattern.md"}}}